<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>AWIFS - Mock Stock Competition</title>
  <style>
    /* RESET */
    * { margin: 0; padding: 0; box-sizing: border-box; }
    body, html { font-family: 'Arial', sans-serif; background: #f4f7f9; color: #333; }
    
    /* SIDEBAR */
    .sidebar {
      position: fixed;
      top: 0;
      left: 0;
      width: 220px;
      height: 100vh;
      background-color: #2c3e50;
      color: #ecf0f1;
      padding: 20px;
      overflow-y: auto;
    }
    .sidebar h2 {
      text-align: center;
      margin-bottom: 10px;
      font-size: 24px;
      letter-spacing: 2px;
    }
    .sidebar p {
      text-align: center;
      margin-bottom: 30px;
      font-size: 16px;
    }
    .sidebar ul {
      list-style: none;
    }
    .sidebar ul li {
      padding: 15px 20px;
      margin-bottom: 10px;
      cursor: pointer;
      border-radius: 3px;
    }
    .sidebar ul li:hover, .sidebar ul li.active {
      background-color: #34495e;
    }
    
    /* MAIN CONTENT */
    .main-content {
      margin-left: 240px;
      padding: 20px;
    }
    .card {
      background: #fff;
      padding: 20px;
      margin-bottom: 20px;
      border-radius: 5px;
      box-shadow: 0 2px 4px rgba(0,0,0,0.1);
    }
    h2.section-title { margin-bottom: 15px; }
    
    /* TABLE STYLES */
    table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 10px;
    }
    th, td { padding: 10px; border: 1px solid #bdc3c7; text-align: left; }
    th { background: #ecf0f1; }
    
    /* FORM STYLES */
    form label { display: block; margin: 10px 0 5px; }
    form input, form select { padding: 8px; width: 100%; border: 1px solid #ccc; border-radius: 3px; }
    form button { margin-top: 15px; padding: 10px 15px; border: none; background-color: #27ae60; color: #fff; border-radius: 3px; cursor: pointer; }
  </style>
</head>
<body>
  <!-- Sidebar -->
  <div class="sidebar">
    <h2>AWIFS Mock Stock</h2>
    <p>UID: A2</p>
    <p>Name: Kamya</p>
    <ul>
      <li class="active" onclick="showSection('dashboard')">Dashboard</li>
      <li onclick="showSection('trade')">Trade</li>
      <li onclick="showSection('portfolio')">Portfolio</li>
      <li onclick="showSection('news')">News</li>
      <li onclick="showSection('leaderboard')">Leaderboard</li>
    </ul>
  </div>
  
  <!-- Main Content -->
  <div class="main-content">
    <!-- Dashboard Section -->
    <div id="dashboard" class="section" style="display: block;">
      <div class="card">
        <h2 class="section-title">Dashboard</h2>
        <table>
          <thead>
            <tr>
              <th>Stock</th>
              <th>Price</th>
              <th>% Change</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td>THC</td>
              <td>$100</td>
              <td>+1%</td>
            </tr>
            <tr>
              <td>Fuel Zone</td>
              <td>$200</td>
              <td>-0.5%</td>
            </tr>
          </tbody>
        </table>
      </div>
      
      <div class="card">
        <h2 class="section-title">Recent Transactions</h2>
        <table>
          <thead>
            <tr>
              <th>Time</th>
              <th>Stock</th>
              <th>Type</th>
              <th>Quantity</th>
              <th>Price</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td>12:01</td>
              <td>THC</td>
              <td>Buy</td>
              <td>10</td>
              <td>$100</td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>
    
    <!-- Trade Section -->
    <div id="trade" class="section" style="display: none;">
      <div class="card">
        <h2 class="section-title">Trade Request</h2>
        <!-- Buyer (Kamya) sends a trade request -->
        <form id="tradeForm" onsubmit="submitTradeRequest(event)">
          <label for="sellerUID">Seller UID:</label>
          <input type="text" id="sellerUID" placeholder="Enter Seller UID" required>
          <label for="stock">Stock Symbol:</label>
          <input type="text" id="stock" placeholder="e.g., AAPL" required>
          <label for="quantity">Quantity:</label>
          <input type="number" id="quantity" placeholder="Number of Shares" required>
          <label for="price">Agreed Price:</label>
          <input type="number" id="price" placeholder="Price per Share" required>
          <button type="submit">Send Trade Request</button>
        </form>
      </div>
      <div class="card">
        <h2 class="section-title">Pending Trade Requests</h2>
        <!-- This table displays trade requests for which Kamya is the seller (if any) -->
        <table id="tradeRequestsTable">
          <thead>
            <tr>
              <th>Buyer UID</th>
              <th>Buyer Name</th>
              <th>Stock</th>
              <th>Quantity</th>
              <th>Price</th>
              <th>Time</th>
            </tr>
          </thead>
          <tbody></tbody>
        </table>
      </div>
    </div>
    
    <!-- Other sections (Portfolio, News, Leaderboard) would be added similarly -->
  </div>
  
  <script>
    // Function to switch between sections
    function showSection(section) {
      document.querySelectorAll('.section').forEach(sec => sec.style.display = 'none');
      document.getElementById(section).style.display = 'block';
    }
    
    // Replace with your deployed Apps Script Web App URL
    const SCRIPT_URL = "https://script.google.com/macros/s/AKfycbyEiHHzllx1fUgY3y8AevxzqcQP1xL3RnmBKKYoBgmMZvNQ-ZRXBXG4m15Ko6n4YRjy_A/exec";
    
    // Function to submit a trade request (from buyer side)
    async function submitTradeRequest(event) {
      event.preventDefault();
      const tradeData = {
        action: "submitTradeRequest",
        buyerUID: "A2",         // Kamya's UID (since this is her portal)
        buyerName: "Kamya",
        sellerUID: document.getElementById("sellerUID").value.trim(),
        stock: document.getElementById("stock").value.trim(),
        quantity: document.getElementById("quantity").value,
        price: document.getElementById("price").value
      };
      
      try {
        const response = await fetch(SCRIPT_URL, {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify(tradeData)
        });
        const result = await response.json();
        alert(result.message);
        loadTradeRequests(); // Refresh pending requests
      } catch (error) {
        console.error("Error submitting trade request:", error);
      }
    }
    
    // Function to load pending trade requests for the logged-in user as seller
    async function loadTradeRequests() {
      // For this demo, assume Kamya (UID A2) is acting as seller when she views this section.
      try {
        const response = await fetch(SCRIPT_URL + '?action=getTradeRequests&sellerUID=A2');
        const data = await response.json();
        const tbody = document.querySelector('#tradeRequestsTable tbody');
        tbody.innerHTML = '';
        if (data.success && data.tradeRequests && data.tradeRequests.length > 0) {
          data.tradeRequests.forEach(req => {
            tbody.innerHTML += `<tr>
              <td>${req.buyerUID}</td>
              <td>${req.buyerName}</td>
              <td>${req.stock}</td>
              <td>${req.quantity}</td>
              <td>$${req.price}</td>
              <td>${new Date(req.timestamp).toLocaleString()}</td>
            </tr>`;
          });
        } else {
          tbody.innerHTML = '<tr><td colspan="6">No pending trade requests.</td></tr>';
        }
      } catch (error) {
        console.error('Error loading trade requests:', error);
      }
    }
    
    // Load pending trade requests on page load (for demonstration)
    loadTradeRequests();
  </script>
  
  <!-- Optionally include Chart.js or other libraries for performance charts -->
</body>
</html>
